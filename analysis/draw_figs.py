import csv
import matplotlib.pyplot as plt
import numpy as np
time_panic = '''|        0~10        |   473.496354208656  |
|       10~20        |  474.9724320935864  |
|       20~30        |  1145.017413864617  |
|       30~40        |  474.5550360089617  |
|       40~50        |  474.16213150264514 |
|       50~60        |  947.1475146043855  |
|       60~70        |  949.7693347785116  |
|       70~80        |   978.251301542306  |
|       80~90        |  975.6373070869688  |
|       90~100       |  476.48923446236336 |
|      100~110       |  478.5018147790654  |
|      110~120       |  476.7647502363624  |
|      120~130       |  1103.4151904157968 |
|      130~140       |  475.3598403811684  |
|      140~150       |  1844.118481387126  |
|      150~160       |  477.26211029433887 |
|      160~170       |  478.4247586743709  |
|      170~180       |  475.98530096957165 |
|      180~190       |  479.5637136684919  |
|      190~200       |  476.2895069324635  |
|      200~210       |  480.77494103063486 |
|      210~220       |   478.696951979636  |
|      220~230       |  479.1505991777439  |
|      230~240       |  480.59407661141034 |
|      240~250       |  481.1490727378265  |
|      250~260       |  480.9854606927931  |
|      260~270       |  475.63492499999495 |
|      270~280       |  484.57648779908277 |
|      280~290       |  2294.3498071898402 |
|      290~300       |  478.8015911477229  |
|      300~310       |  474.8515463075232  |
|      310~320       |  480.3946549237301  |
|      320~330       |  480.0343356431903  |
|      330~340       |  482.52775314464435 |
|      340~350       |  486.2300702809471  |
|      350~360       |  482.14484097000513 |
|      360~370       |  480.01379552604834 |
|      370~380       |  480.6148658875024  |
|      380~390       |  481.86196155996555 |
|      390~400       |  479.1705267583703  |
|      400~410       |  484.1228154859887  |
|      410~420       |  490.5927977710904  |
|      420~430       |  484.7759229764091  |
|      430~440       |  480.35901902429384 |
|      440~450       |  481.00231158275596 |
|      450~460       |  478.69419470585353 |
|      460~470       |  493.1795984314867  |
|      470~480       |  485.34664688486146 |
|      480~490       |  485.57022026689344 |
|      490~500       |  493.7889794010955  |
|      500~510       |  480.6511898478575  |
|      510~520       |  492.7907652213829  |
|      520~530       |  481.00927835593234 |
|      530~540       |  489.08516305057054 |
|      540~550       |  496.63358985426333 |
|      550~560       |  489.23593539439787 |
|      560~570       |  7636.511647283197  |
|      570~580       |  490.20131836067753 |
|      580~590       |  485.32178647039683 |
|      590~600       |  485.2348371548597  |
|      600~610       |  488.66633429479054 |
|      610~620       |  478.3935433055344  |
|      620~630       |  497.39989334129376 |
|      630~640       |  488.77755320483806 |
|      640~650       |  487.90286954834806 |
|      650~660       |  491.76755879559323 |
|      660~670       |  490.7427282210589  |
|      670~680       |  482.82431087369145 |
|      680~690       |  484.00439840588683 |
|      690~700       |  496.20901744747573 |
|      700~710       |  498.53528597176495 |
|      710~720       |  491.25880282023616 |
|      720~730       |  490.39810364169034 |
|      730~740       |  506.71264952836117 |
|      740~750       |   484.372338537486  |
|      750~760       |  486.83041648453576 |
|      760~770       |  497.7858326376595  |
|      770~780       |  488.6127308842006  |
|      780~790       |  477.19685342800517 |
|      790~800       |  488.92439855235705 |
|      800~810       |  485.6322432391079  |
|      810~820       |  488.6731563440514  |
|      820~830       |  499.13831868220393 |
|      830~840       |  496.8965757989242  |
|      840~850       |  497.63395552938937 |
|      850~860       |  494.6338695666443  |
|      860~870       |  491.63077908189524 |
|      870~880       |  493.3767558792466  |
|      880~890       |  503.16020655149316 |
|      890~900       |  501.1260093422284  |
|      900~910       |  501.48089858166355 |
|      910~920       |  496.4896628613894  |
|      920~930       |  493.9748494630539  |
|      930~940       |  501.5518605936545  |
|      940~950       |  492.3395162463894  |
|      950~960       |  501.9993931486647  |
|      960~970       |  498.97821391136205 |
|      970~980       |  497.9932189299746  |
|      980~990       |  494.1688691224755  |
|      990~1000      |  511.63374063816866 |'''


time_deepfix = '''|        0~10        |  24.422705680115023 |
|       10~20        |   40.3447903815709  |
|       20~30        |  55.33200722470569  |
|       30~40        |  67.34788969967471  |
|       40~50        |  79.85849171172714  |
|       50~60        |   93.565180349433   |
|       60~70        |  105.7645541278194  |
|       70~80        |  118.0129194602029  |
|       80~90        |  131.24636293132215 |
|       90~100       |  143.18591419137417 |
|      100~110       |  154.34041666261308 |
|      110~120       |  166.1545689591071  |
|      120~130       |  178.3012956821908  |
|      130~140       |  187.76577902787446 |
|      140~150       |  206.2267456739809  |
|      150~160       |  213.30386706112864 |
|      160~170       |  228.65735811475207 |
|      170~180       |  240.89082600424135 |
|      180~190       |  250.31495733152536 |
|      190~200       |  258.9857356193605  |
|      200~210       |  274.92170270368433 |
|      210~220       |  280.25038875692877 |
|      220~230       |  292.1988900914984  |
|      230~240       |  307.9146840708127  |
|      240~250       |  315.7677556389369  |
|      250~260       |  328.46508812513025 |
|      260~270       |  338.7182208135097  |
|      270~280       |  353.3785836136806  |
|      280~290       |  358.0782836074106  |
|      290~300       |  369.80949400659824 |
|      300~310       |  395.01225835497144 |
|      310~320       |  392.6813690549702  |
|      320~330       |  410.1250406246555  |
|      330~340       |  412.00149940110737 |
|      340~350       |  420.74851813248745 |
|      350~360       |  449.0666977027084  |
|      360~370       |   442.993068639709  |
|      370~380       |  450.15435738005743 |
|      380~390       |  479.0634717078146  |
|      390~400       |   480.64888391077   |
|      400~410       |   512.564342351771  |
|      410~420       |  506.8003114801303  |
|      420~430       |  523.3282327691146  |
|      430~440       |  535.7277811547115  |
|      440~450       |  542.9846472624799  |
|      450~460       |   561.514895551449  |
|      460~470       |  574.1397736211956  |
|      470~480       |  575.5855560605887  |
|      480~490       |  585.8512899886563  |
|      490~500       |  606.8052599452203  |
|      500~510       |  596.5791585378266  |
|      510~520       |  616.2391211704197  |
|      520~530       |  610.8910131405282  |
|      530~540       |  640.0834411810622  |
|      540~550       |  635.3854107611412  |
|      550~560       |   644.843963142159  |
|      560~570       |  658.4845950971337  |
|      570~580       |  656.5196271702869  |
|      580~590       |  705.5424694138859  |
|      590~600       |  705.8693150768415  |
|      600~610       |  745.1447970934311  |
|      610~620       |  726.2891969749808  |
|      620~630       |  737.3555860726544  |
|      630~640       |  744.3287615803163  |
|      640~650       |   748.721984777972  |
|      650~660       |  777.1461890180803  |
|      660~670       |  780.9288267935516  |
|      670~680       |  795.4215496697088  |
|      680~690       |  763.8943894535914  |
|      690~700       |  795.9313845380872  |
|      700~710       |  867.0456822131604  |
|      710~720       |  856.4763624621461  |
|      720~730       |  823.7412682872393  |
|      730~740       |  867.0831956945684  |
|      740~750       |  871.8873711392864  |
|      750~760       |  897.4028322316645  |
|      760~770       |  924.5797375397618  |
|      770~780       |  898.0103932614809  |
|      780~790       |   908.781519228972  |
|      790~800       |  931.4987245392472  |
|      800~810       |  963.6728343072276  |
|      810~820       |  986.7845426031653  |
|      820~830       |  963.2209384047997  |
|      830~840       |  925.5945305040991  |
|      840~850       |  943.1852578777083  |
|      850~860       |   987.50655569183   |
|      860~870       |  1063.9521995888247 |
|      870~880       |  1050.5016807627087 |
|      880~890       |  1025.1680895816437 |
|      890~900       |  1025.8300027675396 |
|      900~910       |  1060.2065126445939 |
|      910~920       |   1020.97846348544  |
|      920~930       |  1059.3685537490678 |
|      930~940       |  1129.5401602203672 |
|      940~950       |  1125.0548102386283 |
|      950~960       |  1165.3499228180424 |
|      960~970       |  1085.2598033135082 |
|      970~980       |  1173.210054288026  |
|      980~990       |  1172.960794362412  |
|      990~1000      |  1191.2954629611652 |'''

time_rlassist_dnr = '''|        0~10        |  4816.692670146626  |
|       10~20        |  10932.691753258237 |
|       20~30        |  12715.103774158126 |
|       30~40        |  12282.245637580947 |
|       40~50        |  14204.028274750981 |
|       50~60        |  14892.566756747108 |
|       60~70        |  16011.917543205564 |
|       70~80        |  16326.750067171331 |
|       80~90        |  16104.988114386693 |
|       90~100       |  16495.223122920852 |
|      100~110       |  16143.050711437094 |
|      110~120       |  16134.030619768382 |
|      120~130       |  15277.427888483404 |
|      130~140       |  17953.596973819425 |
|      140~150       |  16648.678027715236 |
|      150~160       |  17999.692350059984 |
|      160~170       |  17584.95734837491  |
|      170~180       |  17759.73124137701  |
|      180~190       |  18956.390842660734 |
|      190~200       |  19806.40200820894  |
|      200~210       |  22377.28089378956  |
|      210~220       |  19108.94017941969  |
|      220~230       |  16918.638307115652 |
|      230~240       |  16080.389334542928 |
|      240~250       |  16511.252603321234 |
|      250~260       |  18658.467872817346 |
|      260~270       |  17724.429058766782 |
|      270~280       |  17987.56448019898  |
|      280~290       |  16257.860936370967 |
|      290~300       |  17975.008293967476 |
|      300~310       |  17965.781788130604 |
|      310~320       |  15300.083550131594 |
|      320~330       |  15260.807408209446 |
|      330~340       |  17223.43608571377  |
|      340~350       |  18005.829386730133 |
|      350~360       |  17980.105976484578 |
|      360~370       |  17030.585362538564 |
|      370~380       |  18873.732995259255 |
|      380~390       |  15343.778733643869 |
|      390~400       |  16798.804229087367 |
|      400~410       |  17700.499854637506 |
|      410~420       |  15598.230220047275 |
|      420~430       |  15184.032957600642 |
|      430~440       |  16708.80129439599  |
|      440~450       |  17866.170059320917 |
|      450~460       |  14098.616758056656 |
|      460~470       |  18087.702246917997 |
|      470~480       |  15957.101117307559 |
|      480~490       |  15868.175056339991 |
|      490~500       |  16032.53648425903  |
|      500~510       |  19419.122377964355 |
|      510~520       |   18859.4867735143  |
|      520~530       |  18121.43329714834  |
|      530~540       |  17639.518048007045 |
|      540~550       |  15231.13237381115  |
|      550~560       |  18846.827090122864 |
|      560~570       |  18574.71968488721  |
|      570~580       |  20313.143356149103 |
|      580~590       |  18293.291790185616 |
|      590~600       |  17531.751963661252 |
|      600~610       |  19764.242454644485 |
|      610~620       |  18456.467786001926 |
|      620~630       |  17365.996662152436 |
|      630~640       |  18174.950421697245 |
|      640~650       |  19439.317538372758 |
|      650~660       |  17931.168368427745 |
|      660~670       |  22117.932767437615 |
|      670~680       |  27486.056224589527 |
|      680~690       |  19660.57794585112  |
|      690~700       |  18837.514674374008 |
|      700~710       |  21380.443472753683 |
|      710~720       |  20078.44342966614  |
|      720~730       |  19305.486847282667 |
|      730~740       |  19532.22590642137  |
|      740~750       |  21313.599659365154 |
|      750~760       |  20368.177220139925 |
|      760~770       |  20762.23582373794  |
|      770~780       |  21621.87557043479  |
|      780~790       |  20943.557890130465 |
|      790~800       |  22150.222790990258 |
|      800~810       |  20077.60223860879  |
|      810~820       |  20362.75278994232  |
|      820~830       |  22382.288870910863 |
|      830~840       |  22119.268611387346 |
|      840~850       |   23905.7143447979  |
|      850~860       |  23218.98199479618  |
|      860~870       |  22154.663181380427 |
|      870~880       |  23894.117093874447 |
|      880~890       |  24332.42432688987  |
|      890~900       |  22894.12549941124  |
|      900~910       |  22272.83470583322  |
|      910~920       |  24746.502125239782 |
|      920~930       |  24086.29715646128  |
|      930~940       |  25244.47364809672  |
|      940~950       |  22217.52944480448  |
|      950~960       |  23216.498741969073 |
|      970~980       |  25966.61422008781  |
|      980~990       |  26419.259738787026 |
|      990~1000      |  24661.53542504413  |'''

time_rlassist = '''|        0~10        |  183.49284316696264 |
|       10~20        |  268.19929479921757 |
|       20~30        |  275.03010898019494 |
|       30~40        |  313.54633702825237 |
|       40~50        |  368.1143350132293  |
|       50~60        |  417.6030300018366  |
|       60~70        |  478.96339736090727 |
|       70~80        |  554.9525983670271  |
|       80~90        |  624.4789178105922  |
|       90~100       |  701.8418709835944  |
|      100~110       |  787.0687608889372  |
|      110~120       |  863.5727742253971  |
|      120~130       |  960.7359650929757  |
|      130~140       |  1056.9482820403432 |
|      140~150       |  1153.8754767431114 |
|      150~160       |  1251.6547558435745 |
|      160~170       |  1377.0758597110598 |
|      170~180       |  1503.2760320756183 |
|      180~190       |  1627.9328754275223 |
|      190~200       |  1775.9427483486447 |
|      200~210       |  1913.0497646590477 |
|      210~220       |  2047.2453689052438 |
|      220~230       |  2149.1530182096562 |
|      230~240       |  2264.070809558388  |
|      240~250       |  2447.4084225768406 |
|      250~260       |  2617.123211537434  |
|      260~270       |  2799.1631987946284 |
|      270~280       |  2960.0216576566627 |
|      280~290       |  3054.2478808413243 |
|      290~300       |  3306.8369962199968 |
|      300~310       |  3452.7362778066977 |
|      310~320       |  3701.9540139693217 |
|      320~330       |  3845.7329055791274 |
|      330~340       |  4056.2407137552914 |
|      340~350       |  4247.654681970118  |
|      350~360       |  4323.231206617408  |
|      360~370       |  4595.792936980863  |
|      370~380       |  4836.185416222757  |
|      380~390       |  5058.503290691659  |
|      390~400       |  5320.725954683495  |
|      400~410       |   5420.53400419815  |
|      410~420       |  5599.144050374255  |
|      420~430       |  5955.339886545974  |
|      430~440       |  6079.292339506787  |
|      440~450       |  6404.377270506246  |
|      450~460       |  6505.455617439252  |
|      460~470       |  6791.406198892462  |
|      470~480       |  7006.269402200938  |
|      480~490       |  7429.242117201281  |
|      490~500       |  7564.464654051492  |
|      500~510       |  7839.859067877628  |
|      510~520       |  8231.244678355963  |
|      520~530       |  8235.227562375829  |
|      530~540       |  8567.991241637901  |
|      540~550       |  8550.349982687472  |
|      550~560       |  9059.412548899421  |
|      560~570       |  9291.232750911451  |
|      570~580       |  9430.599738577343  |
|      580~590       |  9716.379409861183  |
|      590~600       |  10008.628453881003 |
|      600~610       |  10614.593614899739 |
|      610~620       |  10379.510504232543 |
|      620~630       |  10554.99698768453  |
|      630~640       |  11018.378442618505 |
|      640~650       |  11100.86228948008  |
|      650~660       |  11380.808916034122 |
|      660~670       |  11745.22213418652  |
|      670~680       |  11747.93451789453  |
|      680~690       |  12068.251484308694 |
|      690~700       |  12399.823399414121 |
|      700~710       |  12175.701770807978 |
|      710~720       |  12572.378100729804 |
|      720~730       |  12510.153762426828 |
|      730~740       |  12758.115773549069 |
|      740~750       |  13175.027150715161 |
|      750~760       |  13492.484121648262 |
|      760~770       |  13514.21289642042  |
|      770~780       |  13858.840947552077 |
|      780~790       |  13642.009420588136 |
|      790~800       |  14504.067106374416 |
|      800~810       |  14623.30199167068  |
|      810~820       |  14657.56142528958  |
|      820~830       |  14644.117653258543 |
|      830~840       |  14961.211016451469 |
|      840~850       |  14720.98886632173  |
|      850~860       |  15261.732173303873 |
|      860~870       |  15621.51349087393  |
|      870~880       |  15682.112386995492 |
|      880~890       |  15534.686299221374 |
|      890~900       |  15703.194682523199 |
|      900~910       |  15979.884476560484 |
|      910~920       |  16381.653198719558 |
|      920~930       |  16558.717808853526 |
|      930~940       |  16649.36039400488  |
|      940~950       |  16631.709817361814 |
|      950~960       |  16962.931704785988 |
|      960~970       |  17128.094245052605 |
|      970~980       |  17537.28284411652  |
|      980~990       |  17882.510863008254 |
|      990~1000      |  17690.264238625507 |'''

time_cpct_plus = '''
|       10~20        |  440.0023335213731  |
|       20~30        |  443.00770812923713 |
|       30~40        |  443.26899057068874 |
|       40~50        |  444.7778670091789  |
|       50~60        |  445.44358011066237 |
|       60~70        |   447.157154677699  |
|       70~80        |  446.9370099322752  |
|       80~90        |  447.9188473489704  |
|       90~100       |  447.57072333438947 |
|      100~110       |  448.14940991986697 |
|      110~120       |  449.2111112907686  |
|      120~130       |  448.0663840863993  |
|      130~140       |  448.6879307650381  |
|      140~150       |   447.197334985991  |
|      150~160       |  451.33975117901736 |
|      160~170       |  449.6973265446601  |
|      170~180       |  449.7847629113314  |
|      180~190       |  449.16842015110217 |
|      190~200       |  449.07345490239317 |
|      200~210       |  450.7477115984695  |
|      210~220       |  454.5734900089451  |
|      220~230       |  450.2953878282276  |
|      230~240       |  451.0241723144669  |
|      240~250       |  452.68982502714863 |
|      250~260       |  454.4054652650005  |
|      260~270       |  454.7196738554614  |
|      270~280       |  450.92570913264353 |
|      280~290       |  450.86567701185277 |
|      290~300       |  454.37570207426404 |
|      300~310       |  450.95847364606755 |
|      310~320       |  456.8394206168796  |
|      320~330       |  453.41001553487513 |
|      330~340       |  455.8577997016108  |
|      340~350       |  455.50969081003535 |
|      350~360       |  453.12885783265364 |
|      360~370       |  456.3723071711916  |
|      370~380       |  457.5270988050866  |
|      380~390       |  458.67685968800646 |
|      390~400       |  457.2293301029582  |
|      400~410       |  457.22730848544603 |
|      410~420       |  455.08380285939575 |
|      420~430       |  457.1537902013896  |
|      430~440       |  456.78590969083007 |
|      440~450       |  457.8974140547103  |
|      450~460       |  461.4070289521188  |
|      460~470       |  462.45499469004096 |
|      470~480       |  458.3637412938447  |
|      480~490       |  456.0398488142178  |
|      490~500       |  461.29310984629365 |
|      500~510       |  457.86136381686083 |
|      510~520       |  461.26178778008506 |
|      520~530       |  453.28730299821075 |
|      530~540       |  455.2414387598576  |
|      540~550       |  458.20627978201145 |
|      550~560       |   458.435566010342  |
|      560~570       |  464.06221799676536 |
|      570~580       |  471.24683215324507 |
|      580~590       |  460.29803135592385 |
|      590~600       |  464.16028259038933 |
|      600~610       |  472.78424507129006 |
|      610~620       |  467.35120826943063 |
|      620~630       |  472.41883382688053 |
|      630~640       |  474.56772401735117 |
|      640~650       |  469.01237088323455 |
|      650~660       |  464.31496508955576 |
|      660~670       |  476.0049494320444  |
|      670~680       |  466.8092566604835  |
|      680~690       |  454.81514800075354 |
|      690~700       |  463.5035663332216  |
|      700~710       |  464.9840844340653  |
|      710~720       |  463.4894307663164  |
|      720~730       |  465.3753785760404  |
|      730~740       |  463.77536183518424 |
|      740~750       |  457.83300803252945 |
|      750~760       |  464.0577475236599  |
|      760~770       |  472.7894432470234  |
|      770~780       |  465.8806273466611  |
|      780~790       |  466.42316642123683 |
|      790~800       |  470.7173224639622  |
|      800~810       |  474.42588359239863 |
|      810~820       |  465.97480930858865 |
|      820~830       |  467.70627595338146 |
|      830~840       |  465.0405844823432  |
|      840~850       |  483.3799476597006  |
|      850~860       |  464.47846421643015 |
|      860~870       |  471.08136569472254 |
|      870~880       |  468.2320081467569  |
|      880~890       |  479.55374558652136 |
|      890~900       |  470.63718561962304 |
|      900~910       |  478.58294340386146 |
|      910~920       |   474.004109524582  |
|      920~930       |  467.5311382272385  |
|      930~940       |  476.3834363667922  |
|      940~950       |  476.6044631334129  |
|      950~960       |  477.95456569580796 |
|      960~970       |  486.27116567076195 |
|      970~980       |  495.68291981074225 |
|      980~990       |  467.8244055275267  |
|      990~1000      |  472.50698993940364 |'''



def save_csv(data):
    with open('./res.csv', 'w') as f:
        writer = csv.writer(f)
        writer.writerows(data)


def time_data_to_csv(time_res):
    time_data = time_res.split('|\n')
    data_to_store = []
    for item in time_data:
        data = item.split('|')
        if len(data) == 3:
            data_to_store.append([data[1].strip(), data[2].strip()])
    save_csv(data_to_store)


def visualiztion_time_data(time_res_list, tool_list):
    markers = ['x', '+', '.', '.']
    plt.axes(yscale = "log")
    plt.xlabel('Program Token Length')
    plt.ylabel('Average Repair Time (ms)')
    plt.title('Average Repair Time By Token Length',fontsize='large', fontweight='bold') 
    for i, time_res in enumerate(time_res_list):
        x = []
        y = []
        time_data = time_res.split('|\n')
        data_to_store = []
        for item in time_data:
            data = item.split('|')
            token_length = data[1].strip().split('~')[0]
            if len(data) == 3:
                x.append(int(token_length))
                y.append(float(data[2].strip()))
        print(tool_list[i], end=': ')
        print(np.sum(y) / len(y))

        plt.plot(x, y, label=tool_list[i], marker=markers[i])
    plt.legend()
    plt.show()

visualiztion_time_data([time_rlassist, time_cpct_plus, time_deepfix, time_panic], ['RLAssist', 'CPCT+', 'Deepfix', "Panic"])